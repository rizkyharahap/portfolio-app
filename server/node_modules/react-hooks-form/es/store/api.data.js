(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "lodash/get", "lodash/set"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("lodash/get"), require("lodash/set"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.get, global.set);
    global.apiData = mod.exports;
  }
})(this, function (_exports, _get, _set) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.default = apiData;
  _get = _interopRequireDefault(_get);
  _set = _interopRequireDefault(_set);

  function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

  function apiData(params, api) {
    var formName = params.formName,
        state = params.formState,
        notifyWatchers = params.notifyWatchers,
        watch = params.watch;

    api.logState = function () {// console.log('VALUES', state.values);
      // console.log('STATUS', state.meta);
      // console.log('LAST_INITIALIZED_VALUES', state.lastInitializedValues);
      // console.log('----------------------------------------------------');
    };

    api.getFlatData = function (path) {
      return state[path];
    };

    api.setFlatData = function (path, value) {
      state[path] = value;
      api.logState();
    };

    api.getDeepData = function (path) {
      return (0, _get.default)(state, path);
    };

    api.setDeepData = function (path, value) {
      (0, _set.default)(state, path, value);
      api.logState();
    };

    api.getName = function () {
      return formName;
    };

    api.setProps = function (props) {
      return state.props = props;
    };

    api.getFormValues = function () {
      return api.getFlatData('values');
    };

    api.watchFormValues = function (listener) {
      return watch("".concat(formName, "/values"), listener);
    };

    api.notifyFormValuesWatchers = function () {
      return notifyWatchers("".concat(formName, "/values"), api.getFormValues());
    };

    api.getFormMeta = function (key) {
      return key ? api.getDeepData("meta.".concat(key)) : api.getFlatData('meta');
    };

    api.watchFormMeta = function (listener) {
      return watch("".concat(formName, "/meta"), listener);
    };

    api.notifyFormMetaWatchers = function () {
      return notifyWatchers("".concat(formName, "/meta"), api.getFormMeta());
    };

    api.changeFormMeta = function (payload) {
      api.setFlatData('meta', _objectSpread({}, api.getFormMeta(), payload));
      api.notifyFormMetaWatchers();
    };
  }
});